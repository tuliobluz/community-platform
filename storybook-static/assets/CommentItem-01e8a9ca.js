import{j as t,a as e}from"./jsx-runtime-913be41c.js";import{r as o}from"./index-2506bfc3.js";import{B as w}from"./Button-c1e2a791.js";import{C as F}from"./ConfirmModal-0560c552.js";import{E as O}from"./EditComment-2a6d43bd.js";import{L as U}from"./LinkifyText-46fe28a8.js";import{M as L}from"./Modal-7d6bff05.js";import{U as z}from"./Username-a28a2833.js";import{F as r,B as G,A as P,b as c}from"./theme-ui-components.esm-29c4d01e.js";const $=129,W=n=>n?new Date(n).toLocaleDateString("en-GB").replace(/\//g,"-"):"",g=n=>{const a=o.createRef(),[C,l]=o.useState(!1),[S,s]=o.useState(!1),[E,v]=o.useState(0),[d,D]=o.useState(!1),{comment:I,handleDelete:u,handleEditRequest:f,handleEdit:p,isReply:M,showAvatar:_}=n,{text:h,creatorName:b,creatorCountry:q,creatorImage:x,isUserVerified:R,isUserSupporter:A,isEditable:V,_created:B,_edited:y,_id:i}=I,T={userName:b,countryCode:q,isVerified:!!R,isSupporter:!!A},j=W(y||B),k=d?"max-content":"128px";o.useEffect(()=>{a.current&&v(a.current.scrollHeight)},[a]);const H=()=>{D(!d)},N=m=>{if(f)return f(m),l(!0)};return t(r,{id:`comment:${i}`,"data-cy":"comment",sx:{flexDirection:"column"},children:[t(r,{sx:{gap:2},children:[x&&_&&e(G,{"data-cy":"commentAvatar","data-testid":"commentAvatar",children:e(P,{src:x,sx:{objectFit:"cover",width:["30px","50px"],height:["30px","50px"]}})}),t(r,{sx:{flexDirection:"column",flex:1},children:[t(r,{sx:{alignItems:"stretch",flexWrap:"wrap",justifyContent:"flex-start",flexDirection:["column","row"],gap:2},children:[t(r,{sx:{alignItems:"baseline",gap:2,flexDirection:"row"},children:[e(z,{user:T}),y&&e(c,{sx:{fontSize:0,color:"grey"},children:"(Edited)"}),e(c,{sx:{fontSize:1},children:j})]}),V&&t(r,{sx:{flexGrow:1,gap:2,justifyContent:["flex-start","flex-end"],opacity:.5,":hover":{opacity:1}},children:[e(w,{"data-cy":"CommentItem: edit button",variant:"outline",small:!0,icon:"edit",onClick:()=>N(i),children:"edit"}),e(w,{"data-cy":"CommentItem: delete button",variant:"outline",small:!0,icon:"delete",onClick:()=>s(!0),children:"delete"})]})]}),e(c,{"data-cy":"comment-text",sx:{fontFamily:"body",lineHeight:1.3,maxHeight:k,overflow:"hidden",whiteSpace:"pre-wrap",wordBreak:"break-word",marginY:2},ref:a,children:e(U,{children:h})}),E>$&&e("a",{onClick:H,style:{color:"gray",cursor:"pointer"},children:d?"Show less":"Show more"})]})]}),e(L,{width:600,isOpen:C,children:e(O,{comment:h,handleSubmit:m=>{p&&p(i,m),l(!1)},handleCancel:()=>l(!1),isReply:M})}),e(F,{isOpen:S,message:"Are you sure you want to delete this comment?",confirmButtonText:"Delete",handleCancel:()=>s(!1),handleConfirm:()=>{u&&u(i),s(!1)}})]})};try{g.displayName="CommentItem",g.__docgenInfo={description:"",displayName:"CommentItem",props:{comment:{defaultValue:null,description:"",name:"comment",required:!0,type:{name:"IComment"}},handleDelete:{defaultValue:null,description:"",name:"handleDelete",required:!1,type:{name:"((commentId: string) => Promise<void>)"}},handleEdit:{defaultValue:null,description:"",name:"handleEdit",required:!1,type:{name:"((commentId: string, newCommentText: string) => void)"}},handleEditRequest:{defaultValue:null,description:"",name:"handleEditRequest",required:!1,type:{name:"((commentId: string) => Promise<void>)"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}},showAvatar:{defaultValue:null,description:"",name:"showAvatar",required:!0,type:{name:"boolean"}}}}}catch{}export{g as C};
//# sourceMappingURL=CommentItem-01e8a9ca.js.map
